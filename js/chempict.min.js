!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.ChemPict=n():t.ChemPict=n()}(this,function(){return function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){t.exports=e(1)},function(t,n,e){"use strict";var r=e(2).version,o=e(3),i=e(25),a=e(26),s=e(32),u={SmilesParser:o,WriteChemdoodleJson:function(t){return new i(t)},CoordinateGenerator:a,SvgDepict:s,getVersion:r};t.exports=u},function(t,n){t.exports={name:"chempict",version:"0.0.1",description:"Depict chemical pictures for the web.",main:"dist/chempict.min.js",dependencies:{},devDependencies:{"babel-core":"^6.7.2","babel-loader":"^6.2.4","babel-preset-es2015":"^6.6.0","clang-format":"^1.0.34",eslint:"^2.2.0","eslint-config-google":"^0.4.0",install:"^0.6.0","json-loader":"^0.5.4",mocha:"^2.4.5",npm:"^3.8.2",webpack:"^1.12.14"},scripts:{build:"webpack --progress --colors","build:watch":"webpack --progress --colors --watch",fix:"eslint --fix src/**/*.js",format:"clang-format -i src/**/*.js",lint:"eslint src/**/*.js",test:"mocha --es_staging","test:watch":"mocha --es_staging --watch"},repository:{type:"git",url:"git+https://github.com/benjaminabel/chempict.git"},keywords:["chemistry","molecule","svg","smiles","depict"],author:"Benjamin Abel",license:"Apache-2.0",bugs:{url:"https://github.com/benjaminabel/chempict/issues"},homepage:"https://github.com/benjaminabel/chempict#readme"}},function(t,n,e){"use strict";var r=e(4),o=e(10),i=e(11),a={};a.BondType={NONE:"NONE",SINGLE_BOND:"-",DOUBLE_BOND:"=",TRIPLE_BOND:"#",QUAD_BOND:"$",AROMATIC_BOND:":",ANY:"~"},a.BondStereo={NONE:"NONE",CLOCKWISE:"@",COUNTER_CLOCKWISE:"@@"},a.punctuation={nobond:".",openbranch:"(",closebranch:")",singlebond:a.BondType.SINGLE_BOND,doublebond:a.BondType.DOUBLE_BOND,triplebond:a.BondType.TRIPLE_BOND,quadbond:a.BondType.QUAD_BOND,aromaticbond:a.BondType.AROMATIC_BOND,ringclosure:"%",cis:"/",trans:"\\"},a.smiPattern=new RegExp(/\[[^[]+\]|Br|B|Cl|C|N|F|O|P]|S|c|n|o|s|-|=[0-9]|=[0-9]|=|#[0-9]|#[0-9][0-9]|#|\$|%[0-9][0-9]|[0-9]|\(|\)|./g),a.atomPattern=new RegExp(/^\[([0-9]*)([A-Z][a-z]?|c|n|o|se|s|as)(@|@@)?(H)?([0-9])?([+-][\d]?)?\]$/),a.specialAtoms=["C","c","N","n","O","o","S","s","P","F","Br","Cl","I","B"],a.aromaticAtoms=["c","n","o","s","as","se"],a.parse=function(t){for(var n,e=t.match(a.smiPattern),o=new i(t),s=0,u=a.BondType.NONE,c=[],l=[],f=[],d="",h=[],m=0;m<e.length;m++){var g=e[m],p=parseInt(g[1]+g[2],10);if(g===a.punctuation.nobond);else if(g===a.punctuation.openbranch)c.push(n);else if(g===a.punctuation.closebranch)c.length?n=c.pop():d=" Unbalanced parents";else if(g===a.punctuation.singlebond)u=a.BondType.SINGLE_BOND;else if(g===a.punctuation.doublebond)u=a.BondType.DOUBLE_BOND;else if(g===a.punctuation.triplebond)u=a.BondType.TRIPLE_BOND;else if(g===a.punctuation.quadbond)u=a.BondType.QUAD_BOND;else if(g===a.punctuation.aromaticbond)u=a.BondType.AROMATIC_BOND;else if(g[0]===a.punctuation.ringclosure){var y=l[p];y?(o.addBond(a.createBond(u,n,y)),u=a.BondType.NONE,l[p]=null):l[p]=n}else if(g===a.punctuation.cis);else if(g===a.punctuation.trans);else if(isNaN(p=parseInt(g,10)))if(g.length>1&&(g.startsWith(a.BondType.DOUBLE_BOND)||g.startsWith(a.BondType.TRIPLE_BOND)||g.startsWith(a.BondType.QUAD_BOND))&&!isNaN(p=parseInt(g.substr(1),10)))ringAtom=l[p],ringAtom?(o.addBond(a.createBond(f[p],n,ringAtom)),u=a.BondType.NONE,l[p]=null,f[p]=null):(l[p]=n,f[p]=g.substr(0,1));else{var v=a.parseAtom(g);if(v.symbol){s+=1;var b=new r(v.symbol,0,0,v.charge,v.aromatic,v.isotope);n&&(o.addBond(a.createBond(u,n,b)),u=a.BondType.NONE),o.addAtom(b),"NONE"!==v.stereo&&(h.push(o.indexOfAtom(b)),h.push(v.stereo),h.push(v.chiralHydrogenNeighbour)),n=b}else d=" unknown atom "+g}else{var x=l[p];x?(o.addBond(a.createBond(u,n,x)),u=a.BondType.NONE,l[p]=null):l[p]=n}if(d)throw new Error(t+d)}return a.setChiralCenters(o,h),a.sanityCheck(c,l,u)?o:null},a.sanityCheck=function(t,n,e){if(t.length)throw new Error("unbalanced parens");for(var r=0;r<n.length;++r)if(n[r])throw new Error("unclosed rings");if(e!==a.BondType.NONE)throw new Error("unpaired bond "+e);return!0},a.parseAtom=function(t){var n={isotope:null,symbol:null,stereo:a.BondStereo.NONE,hcount:null,charge:null,aromatic:!1,chiralHydrogenNeighbour:!1},e=a.atomPattern.exec(t);return e?(n.isotope=e[1],a.periodicTable[e[2]]&&(n.symbol=e[2]),e[3]===a.BondStereo.CLOCKWISE||e[3]===a.BondStereo.COUNTER_CLOCKWISE?(n.stereo=e[3],"H"===e[4]&&(n.chiralHydrogenNeighbour=!0)):n.stereo=a.BondStereo.NONE,"H"===e[4]&&(e[5]?n.hcount=e[5]:n.hcount=1),"+"===e[6]?n.charge=1:"-"===e[6]?n.charge=-1:n.charge=parseInt(e[6],10)):a.specialAtoms.includes(t)&&(n.symbol=t),a.aromaticAtoms.includes(n.symbol)&&(n.aromatic=!0,1===n.symbol.length?n.symbol=n.symbol.toUpperCase():n.symbol=n.symbol[0].toUpperCase()+n.symbol[1]),n},a.createBond=function(t,n,e){var r=t;switch(t===a.BondType.NONE&&(r=n.aromatic&&e.aromatic?a.BondType.AROMATIC_BOND:a.BondType.SINGLE_BOND),r){case a.BondType.SINGLE_BOND:return new o(n,e,o.ORDER.SINGLE);case a.BondType.DOUBLE_BOND:return new o(n,e,o.ORDER.DOUBLE);case a.BondType.TRIPLE_BOND:return new o(n,e,o.ORDER.TRIPLE);case a.BondType.AROMATIC_BOND:var i=new o(n,e);return i.aromatic=!0,i;case a.BondType.ANY:default:throw new Error("invalid bond type ["+t+"]")}},a.setChiralCenters=function(t,n){for(var e=0,r=n.length;r>e;e++){var i=n[e],s=t.getAtom(i);if(void 0!==s){var u=n[++e],c=(n[++e],[]),l=0,f=null;t.atoms.forEach(function(n){var e=t.findBond(s,n);null!==e&&void 0!==e&&(e.source!==s&&(e.source=s,e.target=n),l++,t.isBondInRing(e)||c.push(e))});var d=c.length;if((3===l||4===l)&&d>0){var h=0;(3===l&&d>1||4===l&&d>2)&&(h=1),f=c[h],u===a.BondStereo.CLOCKWISE?f.stereo=o.STEREO.UP:f.stereo=o.STEREO.DOWN}4===l&&d>1&&(h=1,4===d?h=3:4===d&&(h=2),f=c[h],u===a.BondStereo.CLOCKWISE?f.stereo=o.STEREO.DOWN:f.stereo=o.STEREO.UP)}}},a.periodicTable={H:{number:1,name:"Hydrogen"},He:{number:2,name:"Helium"},Li:{number:3,name:"Lithium"},Be:{number:4,name:"Beryllium"},B:{number:5,name:"Boron"},C:{number:6,name:"Carbon"},c:{number:6,name:"Carbon"},N:{number:7,name:"Nitrogen"},n:{number:7,name:"Nitrogen"},O:{number:8,name:"Oxygen"},o:{number:8,name:"Oxygen"},F:{number:9,name:"Fluorine"},Ne:{number:10,name:"Neon"},Na:{number:11,name:"Sodium"},Mg:{number:12,name:"Magnesium"},Al:{number:13,name:"Aluminium"},Si:{number:14,name:"Silicon"},P:{number:15,name:"Phosphorus"},S:{number:16,name:"Sulfur"},s:{number:16,name:"Sulfur"},Cl:{number:17,name:"Chlorine"},Ar:{number:18,name:"Argon"},K:{number:19,name:"Potassium"},Ca:{number:20,name:"Calcium"},Sc:{number:21,name:"Scandium"},Ti:{number:22,name:"Titanium"},V:{number:23,name:"Vanadium"},Cr:{number:24,name:"Chromium"},Mn:{number:25,name:"Manganese"},Fe:{number:26,name:"Iron"},Co:{number:27,name:"Cobalt"},Ni:{number:28,name:"Nickel"},Cu:{number:29,name:"Copper"},Zn:{number:30,name:"Zinc"},Ga:{number:31,name:"Gallium"},Ge:{number:32,name:"Germanium"},As:{number:33,name:"Arsenic"},as:{number:33,name:"Arsenic"},Se:{number:34,name:"Selenium"},se:{number:34,name:"Selenium"},Br:{number:35,name:"Bromine"},Kr:{number:36,name:"Krypton"},Rb:{number:37,name:"Rubidium"},Sr:{number:38,name:"Strontium"},Y:{number:39,name:"Yttrium"},Zr:{number:40,name:"Zirconium"},Nb:{number:41,name:"Niobium"},Mo:{number:42,name:"Molybdenum"},Tc:{number:43,name:"Technetium"},Ru:{number:44,name:"Ruthenium"},Rh:{number:45,name:"Rhodium"},Pd:{number:46,name:"Palladium"},Ag:{number:47,name:"Silver"},Cd:{number:48,name:"Cadmium"},In:{number:49,name:"Indium"},Sn:{number:50,name:"Tin"},Sb:{number:51,name:"Antimony"},Te:{number:52,name:"Tellurium"},I:{number:53,name:"Iodine"},Xe:{number:54,name:"Xenon"},Cs:{number:55,name:"Caesium"},Ba:{number:56,name:"Barium"},La:{number:57,name:"Lanthanum"},Ce:{number:58,name:"Cerium"},Pr:{number:59,name:"Praseodymium"},Nd:{number:60,name:"Neodymium"},Pm:{number:61,name:"Promethium"},Sm:{number:62,name:"Samarium"},Eu:{number:63,name:"Europium"},Gd:{number:64,name:"Gadolinium"},Tb:{number:65,name:"Terbium"},Dy:{number:66,name:"Dysprosium"},Ho:{number:67,name:"Holmium"},Er:{number:68,name:"Erbium"},Tm:{number:69,name:"Thulium"},Yb:{number:70,name:"Ytterbium"},Lu:{number:71,name:"Lutetium"},Hf:{number:72,name:"Hafnium"},Ta:{number:73,name:"Tantalum"},W:{number:74,name:"Tungsten"},Re:{number:75,name:"Rhenium"},Os:{number:76,name:"Osmium"},Ir:{number:77,name:"Iridium"},Pt:{number:78,name:"Platinum"},Au:{number:79,name:"Gold"},Hg:{number:80,name:"Mercury"},Tl:{number:81,name:"Thallium"},Pb:{number:82,name:"Lead"},Bi:{number:83,name:"Bismuth"},Po:{number:84,name:"Polonium"},At:{number:85,name:"Astatine"},Rn:{number:86,name:"Radon"},Fr:{number:87,name:"Francium"},Ra:{number:88,name:"Radium"},Ac:{number:89,name:"Actinium"},Th:{number:90,name:"Thorium"},Pa:{number:91,name:"Protactinium"},U:{number:92,name:"Uranium"},Np:{number:93,name:"Neptunium"},Pu:{number:94,name:"Plutonium"},Am:{number:95,name:"Americium"},Cm:{number:96,name:"Curium"},Bk:{number:97,name:"Berkelium"},Cf:{number:98,name:"Californium"},Es:{number:99,name:"Einsteinium"},Fm:{number:100,name:"Fermium"},Md:{number:101,name:"Mendelevium"},No:{number:102,name:"Nobelium"},Lr:{number:103,name:"Lawrencium"},Rf:{number:104,name:"Rutherfordium"},Db:{number:105,name:"Dubnium"},Sg:{number:106,name:"Seaborgium"},Bh:{number:107,name:"Bohrium"},Hs:{number:108,name:"Hassium"},Mt:{number:109,name:"Meitnerium"},Ds:{number:110,name:"Darmstadtium"},Rg:{number:111,name:"Roentgenium"},Cn:{number:112,name:"Copernicium"}},t.exports=a},function(t,n,e){"use strict";var r=e(5),o=e(6),i=e(7),a=e(8),s=e(9),u=function(t,n,e,r,o,a){this.symbol=t?t:"C";var u=n?n:0,c=e?e:0;this.coord=new i(u,c),this.bonds=new Set,this.charge=r?r:0,this.isotope=a?a:0,this.aromatic=o?o:!1,this.hybridization=null,this.flags=new Array(s.MAX_FLAG_INDEX+1)};u.prototype.getSymbol=function(){return this.symbol},u.prototype.getCharge=function(){return this.charge},u.prototype.countBonds=function(){return this.bonds.size},u.prototype.hydrogenCount=function(){var t=o[this.symbol],n=Array.from(this.bonds),e=n.reduce(function(t,n){return t+n.order},0),r=0;return t&&(r=t-e+this.charge),r},u.prototype.getNeighbors=function(){for(var t=Array.from(this.bonds),n=[],e=0,r=t.length;r>e;e++)n.push(t[e].otherAtom(this));return n},u.nextBondAngle=function(t){var n,e=Array.from(t.bonds);if(0===e.length)n=0;else if(1===e.length){var o;!function(){var r=e[0].otherAtom(t),i=void 0,s=a.angle(t.coord.x,t.coord.y,r.coord.x,r.coord.y),u=i.from(t.bonds).map(function(n){var e=n.otherAtom(r),o=void 0;return o=e===t?0:a.angleDifference(s,a.angle(r.coord.x,r.coord.y,e.coord.x,e.coord.y))});u.sort(),o=u[0],n=o>0?s-120:s+120}()}else if(2===e.length){var i=e.map(function(n){var e=n.otherAtom(t);return a.angle(t.coord.x,t.coord.y,e.coord.x,e.coord.y)}),s=a.angleDifference(i[0],i[1]);Math.abs(s)<180?s=180+s/2:s/=2,n=i[0]+s}else if(3===e.length){e.sort(function(n,o){return r.defaultCompare(n.otherAtom(t).Array.from(e).length,o.otherAtom(t).Array.from(e).length)});var u=e.slice(0,2),c=u.map(function(n){var e=n.otherAtom(t);return a.angle(t.coord.x,t.coord.y,e.coord.x,e.coord.y)});n=c[0]+a.angleDifference(c[0],c[1])/2}return n},u.prototype.clone=function(){return new u(this.symbol,this.coord.x,this.coord.y,this.charge,this.aromatic,this.isotope)},u.Hybridizations={S:0,SP1:1,SP2:2,SP3:3,PLANAR3:4,SP3D1:5,SP3D2:6,SP3D3:7,SP3D4:8,SP3D5:9},u.prototype.setFlag=function(t,n){this.flags[t]=n},u.prototype.toString=function(){return"ModelAtom ["+this.symbol+"] "+this.coord.toString()},t.exports=u},function(t,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),o=function(){function t(){e(this,t)}return r(t,null,[{key:"empty",value:function n(t){var n=new Array(t);return n}},{key:"zeros",value:function(t){var n=this.empty(t);return n.fill(0),n}},{key:"full",value:function(t,n){var e=this.empty(t);return e.fill(n),e}},{key:"diff",value:function(t,n){var e=t.filter(function(t){return n.indexOf(t)<0});return e}},{key:"remove",value:function(t,n){return t.indexOf(n)>=0&&t.splice(t.indexOf(n),1),t}},{key:"flatten",value:function(){for(var t=[],n=arguments.length,e=Array(n),r=0;n>r;r++)e[r]=arguments[r];for(var o=0;o<e.length;o++)e[o]instanceof Array?t.push.apply(t,this.flatten.apply(this,e[o])):t.push(e[o]);return t}},{key:"last",value:function(t){return t[t.length-1]}},{key:"defaultCompare",value:function(t,n){var e=void 0;return e=t>n?1:n>t?-1:0}}]),t}();t.exports=o},function(t,n){"use strict";var e={C:4,Si:4,N:3,P:3,O:2,S:2,H:1,Br:1,Cl:1,I:1,F:1};t.exports=e},function(t,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),o=function(){function t(n,r){e(this,t),n=arguments.length<=0||void 0===arguments[0]?0:arguments[0],r=arguments.length<=1||void 0===arguments[1]?0:arguments[1],this.x=n,this.y=r}return r(t,null,[{key:"distance",value:function(t,n){var e=t.x-n.x,r=t.y-n.y;return Math.sqrt(e*e+r*r)}},{key:"sum",value:function(n,e){return new t(n.x+e.x,n.y+e.y)}}]),t}();t.exports=o},function(t,n){"use strict";var e={};e.angle=function(t,n,r,o){return e.standardAngle(e.toDegrees(Math.atan2(o-n,r-t)))},e.standardAngle=function(t){return e.modulo(t,360)},e.modulo=function(t,n){var e=t%n;return 0>e*n?e+n:e},e.toRadians=function(t){return t*Math.PI/180},e.toDegrees=function(t){return 180*t/Math.PI},e.angleDifference=function(t,n){var r=e.standardAngle(n)-e.standardAngle(t);return r>180?r-=360:-180>=r&&(r+=360),r},e.angleDx=function(t,n){return n*Math.cos(e.toRadians(t))},e.angleDy=function(t,n){return n*Math.sin(e.toRadians(t))},t.exports=e},function(t,n){"use strict";var e={ISPLACED:0,VISITED:1,ISINRING:2,MAX_FLAG_INDEX:2};t.exports=e},function(t,n,e){"use strict";var r=e(7),o=function i(t,n,e,r,o,a){this.source=t,this.target=n,this.order=e?e:i.ORDER.SINGLE,this.stereo=r?r:i.STEREO.NOT_STEREO,this.aromatic=o?o:!1,this.molecule=a?a:null};o.prototype.otherAtom=function(t){return t===this.source?this.target:t===this.target?this.source:null},o.prototype.getLength=function(){return r.distance(this.source.coord,this.target.coord)},o.prototype.clone=function(){return new o(this.source,this.target,this.order,this.stereo,this.aromatic,this.molecule)},o.prototype.deepClone=function(){return new o(this.source.clone(),this.target.clone(),this.order,this.stereo,this.aromatic,this.molecule)},o.ORDER={SINGLE:1,DOUBLE:2,TRIPLE:3,QUADRUPLE:4},o.STEREO={NOT_STEREO:10,UP:11,UP_OR_DOWN:12,DOWN:13},o.prototype.toString=function(){var t=this.molecule?this.molecule.name:"no molecule";return"ModelBond["+this.order+", "+this.stereo+"]  "+this.source.toString()+" -- "+this.target.toString()+" mol: "+t},t.exports=o},function(t,n,e){"use strict";var r=e(12),o=e(17),i=e(7),a=e(18),s=e(8),u=e(5),c=e(4),l=e(10),f=e(19),d=function(t){this.bonds=[],this.atoms=[],this.name=t?t:"",this.id=void 0,this.sssr=[],this.mustRecalcSSSR=!0,this.fragments=[],this.fragmentCount=0};d.prototype.resetRingCenters=function(){this.getRings().forEach(function(t){t.resetRingCenter()})},d.prototype.addBond=function(t){var n=this.indexOfAtom(t.source),e=this.indexOfAtom(t.target);if(this.fragments[n]!==this.fragments[e]){var r=void 0,o=void 0;this.fragments[n]<this.fragments[e]?(r=this.fragments[n],o=this.fragments[e]):(o=this.fragments[n],r=this.fragments[e]),this.fragmentCount--;for(var i=0,a=this.atoms.length;a>i;i++)this.fragments[i]===r&&(this.fragments[i]=o)}this.bonds.push(t),t.source.bonds.add(t),t.target.bonds.add(t),this.addAtom(t.source),this.addAtom(t.target),t.molecule=this},d.prototype.getAtom=function(t){return this.atoms[t]},d.prototype.getBond=function(t){return this.bonds[t]},d.prototype.getAverageBondLength=function(){var t=1.25;if(this.bonds.length){var n=this.bonds.reduce(function(t,n){return t+n.getLength()},0);t=n/this.bonds.length}return t},d.prototype.findBond=function(t,n){for(var e=Array.from(t.bonds),r=0,o=e.length;o>r;r++){var i=e[r];if(i.otherAtom(t)===n)return i}return null},d.prototype.indexOfAtom=function(t){return this.atoms.indexOf(t)},d.prototype.indexOfBond=function(t){return this.bonds.indexOf(t)},d.prototype.removeAtom=function(t){var n;t.constructor===Number?n=this.atoms[t]:t.constructor===c&&(n=t);var e=Array.from(n.bonds);e.forEach(function(t){u.remove(this.bonds,t)},this),n.bonds.clear(),u.remove(this.atoms,n),n.molecule=void 0},d.prototype.removeBond=function(t){var n=void 0,e=void 0;n=t.constructor===Number?this.bonds[t]:t,n.source.bonds.remove(n),n.target.bonds.remove(n),0===n.source.Array.from(e).length&&(u.remove(this.atoms,n.source),n.source.molecule=void 0),0===n.target.Array.from(e).length&&(u.remove(this.atoms,n.target),n.target.molecule=void 0),u.remove(this.bonds,n),n.molecule=void 0,n.source=void 0,n.target=void 0},d.prototype.countAtoms=function(){return this.atoms.length},d.prototype.countBonds=function(){return this.bonds.length},d.prototype.addAtom=function(t){if(!this.atoms.includes(t)){var n=this.atoms.length;this.fragmentCount++,this.fragments[n]=this.fragmentCount,this.atoms.push(t),t.molecule=this}},d.prototype.getRings=function(){return this.mustRecalcSSSR&&(this.sssr=f.findRings(this),this.mustRecalcSSSR=!1),this.sssr},d.prototype.isAtomInRing=function(t){for(var n=this.getRings(),e=0,r=n.length;r>e;e++)for(var o=0,i=n[e].atoms.length;i>o;o++)if(t===n[e].atoms[o])return!0;return!1},d.prototype.isBondInRing=function(t){for(var n=this.getRings(),e=0,r=n.length;r>e;e++)for(var o=0,i=n[e].bonds.length;i>o;o++)if(t===n[e].bonds[o])return!0;return!1},d.prototype.clone=function(){var t=new d(this.name);return this.atoms.forEach(function(n){t.addAtom(n)}),this.bonds.forEach(function(n){t.addBond(n)}),t},d.prototype.getFragments=function(){var t=this.clone();if(1===t.fragmentCount)return[t];var n=new Map;return t.atoms.forEach(function(e){var r=t.fragments[t.indexOfAtom(e)];n.has(r)===!1&&n.set(r,new d),n.get(r).addAtom(e)}),t.bonds.forEach(function(e){var r=t.fragments[t.indexOfAtom(e.source)];n.get(r).addBond(e)}),n.getValues()},d.prototype.getConnectedBondsList=function(t){for(var n=[],e=this.bonds.length,r=0;e>r;r++)this.bonds[r].source!==t&&this.bonds[r].target!==t||n.push(this.bonds[r]);return n},d.prototype.toString=function(){return"ModelMolecule - name: "+this.name+"\n	"+this.atoms.map(function(t){return" "+this.indexOfAtom(t)+": "+t.toString()},this).join("\n	")+"\n	"+this.bonds.map(function(t){return" "+this.indexOfAtom(t.source)+", "+this.indexOfAtom(t.target)+":  "+t.toString()},this).join("\n	")+"\n	"+this.getRings().map(function(t){return t.toString()}).join("\n	")},d.prototype.getCenter=function(){var t=this.getBoundingBox();return new i((t.left+t.right)/2,(t.top+t.bottom)/2)},d.prototype.getBoundingBox=function(){return o.boundingBox.apply(null,this.atoms.map(function(t){return t.coord}))},d.prototype.sproutFragment=function(t,n){r(this.atoms.includes(t),"attachmentAtom must belong to this molecule"),r(Object.getPrototypeOf(n.molecule)===Object.prototype,"fragAtom must belong to a molecule");var e=c.nextBondAngle(t);if(void 0!==e){var o=a.fromCoordinate(i.difference(t.coord,n.coord));n.molecule.rotate(e,n.coord),n.molecule.translate(o),d.mergeMolecules(n,t)}},d.prototype.sproutBond=function(t,n,e,r){var o=1.25,a=Array.from(t.bonds);a.length&&(o=a.reduce(function(t,n){return t+i.distance(n.source.coord,n.target.coord)},0)/a.length);var u=c.nextBondAngle(t);if(void 0!==u){var f="C";r&&(f=r);var d=new c(f,t.coord.x+s.angleDx(u,o),t.coord.y+s.angleDy(u,o)),h=new l(t,d,n,e);return this.addAtom(d),this.addBond(h),h}},t.exports=d},function(t,n,e){function r(t,n){return h.isUndefined(n)?""+n:h.isNumber(n)&&!isFinite(n)?n.toString():h.isFunction(n)||h.isRegExp(n)?n.toString():n}function o(t,n){return h.isString(t)?t.length<n?t:t.slice(0,n):t}function i(t){return o(JSON.stringify(t.actual,r),128)+" "+t.operator+" "+o(JSON.stringify(t.expected,r),128)}function a(t,n,e,r,o){throw new p.AssertionError({message:e,actual:t,expected:n,operator:r,stackStartFunction:o})}function s(t,n){t||a(t,!0,n,"==",p.ok)}function u(t,n){if(t===n)return!0;if(h.isBuffer(t)&&h.isBuffer(n)){if(t.length!=n.length)return!1;for(var e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}return h.isDate(t)&&h.isDate(n)?t.getTime()===n.getTime():h.isRegExp(t)&&h.isRegExp(n)?t.source===n.source&&t.global===n.global&&t.multiline===n.multiline&&t.lastIndex===n.lastIndex&&t.ignoreCase===n.ignoreCase:h.isObject(t)||h.isObject(n)?l(t,n):t==n}function c(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function l(t,n){if(h.isNullOrUndefined(t)||h.isNullOrUndefined(n))return!1;if(t.prototype!==n.prototype)return!1;if(h.isPrimitive(t)||h.isPrimitive(n))return t===n;var e=c(t),r=c(n);if(e&&!r||!e&&r)return!1;if(e)return t=m.call(t),n=m.call(n),u(t,n);var o,i,a=y(t),s=y(n);if(a.length!=s.length)return!1;for(a.sort(),s.sort(),i=a.length-1;i>=0;i--)if(a[i]!=s[i])return!1;for(i=a.length-1;i>=0;i--)if(o=a[i],!u(t[o],n[o]))return!1;return!0}function f(t,n){return t&&n?"[object RegExp]"==Object.prototype.toString.call(n)?n.test(t):t instanceof n?!0:n.call({},t)===!0:!1}function d(t,n,e,r){var o;h.isString(e)&&(r=e,e=null);try{n()}catch(i){o=i}if(r=(e&&e.name?" ("+e.name+").":".")+(r?" "+r:"."),t&&!o&&a(o,e,"Missing expected exception"+r),!t&&f(o,e)&&a(o,e,"Got unwanted exception"+r),t&&o&&e&&!f(o,e)||!t&&o)throw o}var h=e(13),m=Array.prototype.slice,g=Object.prototype.hasOwnProperty,p=t.exports=s;p.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=i(this),this.generatedMessage=!0);var n=t.stackStartFunction||a;if(Error.captureStackTrace)Error.captureStackTrace(this,n);else{var e=new Error;if(e.stack){var r=e.stack,o=n.name,s=r.indexOf("\n"+o);if(s>=0){var u=r.indexOf("\n",s+1);r=r.substring(u+1)}this.stack=r}}},h.inherits(p.AssertionError,Error),p.fail=a,p.ok=s,p.equal=function(t,n,e){t!=n&&a(t,n,e,"==",p.equal)},p.notEqual=function(t,n,e){t==n&&a(t,n,e,"!=",p.notEqual)},p.deepEqual=function(t,n,e){u(t,n)||a(t,n,e,"deepEqual",p.deepEqual)},p.notDeepEqual=function(t,n,e){u(t,n)&&a(t,n,e,"notDeepEqual",p.notDeepEqual)},p.strictEqual=function(t,n,e){t!==n&&a(t,n,e,"===",p.strictEqual)},p.notStrictEqual=function(t,n,e){t===n&&a(t,n,e,"!==",p.notStrictEqual)},p["throws"]=function(t,n,e){d.apply(this,[!0].concat(m.call(arguments)))},p.doesNotThrow=function(t,n){d.apply(this,[!1].concat(m.call(arguments)))},p.ifError=function(t){if(t)throw t};var y=Object.keys||function(t){var n=[];for(var e in t)g.call(t,e)&&n.push(e);return n}},function(t,n,e){(function(t,r){function o(t,e){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(e)?r.showHidden=e:e&&n._extend(r,e),A(r.showHidden)&&(r.showHidden=!1),A(r.depth)&&(r.depth=2),A(r.colors)&&(r.colors=!1),A(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),u(r,t,r.depth)}function i(t,n){var e=o.styles[n];return e?"["+o.colors[e][0]+"m"+t+"["+o.colors[e][1]+"m":t}function a(t,n){return t}function s(t){var n={};return t.forEach(function(t,e){n[t]=!0}),n}function u(t,e,r){if(t.customInspect&&e&&B(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var o=e.inspect(r,t);return b(o)||(o=u(t,o,r)),o}var i=c(t,e);if(i)return i;var a=Object.keys(e),g=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),C(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(e);if(0===a.length){if(B(e)){var p=e.name?": "+e.name:"";return t.stylize("[Function"+p+"]","special")}if(S(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(w(e))return t.stylize(Date.prototype.toString.call(e),"date");if(C(e))return l(e)}var y="",v=!1,x=["{","}"];if(m(e)&&(v=!0,x=["[","]"]),B(e)){var A=e.name?": "+e.name:"";y=" [Function"+A+"]"}if(S(e)&&(y=" "+RegExp.prototype.toString.call(e)),w(e)&&(y=" "+Date.prototype.toUTCString.call(e)),C(e)&&(y=" "+l(e)),0===a.length&&(!v||0==e.length))return x[0]+y+x[1];if(0>r)return S(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var E;return E=v?f(t,e,r,g,a):a.map(function(n){return d(t,e,r,g,n,v)}),t.seen.pop(),h(E,y,x)}function c(t,n){if(A(n))return t.stylize("undefined","undefined");if(b(n)){var e="'"+JSON.stringify(n).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(e,"string")}return v(n)?t.stylize(""+n,"number"):g(n)?t.stylize(""+n,"boolean"):p(n)?t.stylize("null","null"):void 0}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,n,e,r,o){for(var i=[],a=0,s=n.length;s>a;++a)D(n,String(a))?i.push(d(t,n,e,r,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(d(t,n,e,r,o,!0))}),i}function d(t,n,e,r,o,i){var a,s,c;if(c=Object.getOwnPropertyDescriptor(n,o)||{value:n[o]},c.get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),D(r,o)||(a="["+o+"]"),s||(t.seen.indexOf(c.value)<0?(s=p(e)?u(t,c.value,null):u(t,c.value,e-1),s.indexOf("\n")>-1&&(s=i?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),A(a)){if(i&&o.match(/^\d+$/))return s;a=JSON.stringify(""+o),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function h(t,n,e){var r=0,o=t.reduce(function(t,n){return r++,n.indexOf("\n")>=0&&r++,t+n.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?e[0]+(""===n?"":n+"\n ")+" "+t.join(",\n  ")+" "+e[1]:e[0]+n+" "+t.join(", ")+" "+e[1]}function m(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function p(t){return null===t}function y(t){return null==t}function v(t){return"number"==typeof t}function b(t){return"string"==typeof t}function x(t){return"symbol"==typeof t}function A(t){return void 0===t}function S(t){return E(t)&&"[object RegExp]"===O(t)}function E(t){return"object"==typeof t&&null!==t}function w(t){return E(t)&&"[object Date]"===O(t)}function C(t){return E(t)&&("[object Error]"===O(t)||t instanceof Error)}function B(t){return"function"==typeof t}function P(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function O(t){return Object.prototype.toString.call(t)}function I(t){return 10>t?"0"+t.toString(10):t.toString(10)}function R(){var t=new Date,n=[I(t.getHours()),I(t.getMinutes()),I(t.getSeconds())].join(":");return[t.getDate(),T[t.getMonth()],n].join(" ")}function D(t,n){return Object.prototype.hasOwnProperty.call(t,n)}var N=/%[sdj%]/g;n.format=function(t){if(!b(t)){for(var n=[],e=0;e<arguments.length;e++)n.push(o(arguments[e]));return n.join(" ")}for(var e=1,r=arguments,i=r.length,a=String(t).replace(N,function(t){if("%%"===t)return"%";if(e>=i)return t;switch(t){case"%s":return String(r[e++]);case"%d":return Number(r[e++]);case"%j":try{return JSON.stringify(r[e++])}catch(n){return"[Circular]"}default:return t}}),s=r[e];i>e;s=r[++e])a+=p(s)||!E(s)?" "+s:" "+o(s);return a},n.deprecate=function(e,o){function i(){if(!a){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),a=!0}return e.apply(this,arguments)}if(A(t.process))return function(){return n.deprecate(e,o).apply(this,arguments)};if(r.noDeprecation===!0)return e;var a=!1;return i};var L,M={};n.debuglog=function(t){if(A(L)&&(L=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!M[t])if(new RegExp("\\b"+t+"\\b","i").test(L)){var e=r.pid;M[t]=function(){var r=n.format.apply(n,arguments);console.error("%s %d: %s",t,e,r)}}else M[t]=function(){};return M[t]},n.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=m,n.isBoolean=g,n.isNull=p,n.isNullOrUndefined=y,n.isNumber=v,n.isString=b,n.isSymbol=x,n.isUndefined=A,n.isRegExp=S,n.isObject=E,n.isDate=w,n.isError=C,n.isFunction=B,n.isPrimitive=P,n.isBuffer=e(15);var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",R(),n.format.apply(n,arguments))},n.inherits=e(16),n._extend=function(t,n){if(!n||!E(n))return t;for(var e=Object.keys(n),r=e.length;r--;)t[e[r]]=n[e[r]];return t}}).call(n,function(){return this}(),e(14))},function(t,n){function e(){c=!1,a.length?u=a.concat(u):l=-1,u.length&&r()}function r(){if(!c){var t=setTimeout(e);c=!0;for(var n=u.length;n;){for(a=u,u=[];++l<n;)a&&a[l].run();l=-1,n=u.length}a=null,c=!1,clearTimeout(t)}}function o(t,n){this.fun=t,this.array=n}function i(){}var a,s=t.exports={},u=[],c=!1,l=-1;s.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];u.push(new o(t,n)),1!==u.length||c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=i,s.addListener=i,s.once=i,s.off=i,s.removeListener=i,s.removeAllListeners=i,s.emit=i,s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,n){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,n){"function"==typeof Object.create?t.exports=function(t,n){t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,n){t.super_=n;var e=function(){};e.prototype=n.prototype,t.prototype=new e,t.prototype.constructor=t}},function(t,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),o=function(){function t(n,r,o,i){e(this,t),this.top=n,this.right=r,this.bottom=o,this.left=i}return r(t,[{key:"expandToIncludeCoordinate",value:function(t){this.top=Math.min(this.top,t.y),this.right=Math.max(this.right,t.x),this.bottom=Math.max(this.bottom,t.y),this.left=Math.min(this.left,t.x)}}],[{key:"boundingBox",value:function(){for(var n=arguments.length,e=Array(n),r=0;n>r;r++)e[r]=arguments[r];for(var o=e[0],i=new t(o.y,o.x,o.y,o.x),a=1;a<e.length;a++)i.expandToIncludeCoordinate(e[a]);return i}}]),t}();t.exports=o},function(t,n){"use strict";var e=function(t,n){arguments.length>0&&(this.x=t,this.y=n)};e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.cross=function(t){return this.x*t.y-this.y*t.x},e.prototype.unit=function(){
return this.divide(this.length())},e.prototype.unitEquals=function(){return this.divideEquals(this.length()),this},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.addEquals=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.subtractEquals=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.multiply=function(t){return new e(this.x*t,this.y*t)},e.prototype.multiplyEquals=function(t){return this.x*=t,this.y*=t,this},e.prototype.divide=function(t){return new e(this.x/t,this.y/t)},e.prototype.divideEquals=function(t){return this.x/=t,this.y/=t,this},e.prototype.perp=function(){return new e(-this.y,this.x)},e.prototype.perpendicular=function(t){return this.subtract(this.project(t))},e.prototype.project=function(t){var n=this.dot(t)/t.dot(t);return t.multiply(n)},e.prototype.toString=function(){return this.x+","+this.y},e.fromPoints=function(t,n){return new e(n.x-t.x,n.y-t.y)},e.prototype.scale=function(t){this.x*=t,this.y*=t},e.prototype.normalize=function(){var t=1/Math.sqrt(this.x*this.x+this.y*this.y);this.x*=t,this.y*=t},e.prototype.sub=function(t){this.x-=t.x,this.y-=t.y},e.prototype.negate=function(t){this.x=-t.x,this.y=-t.y},e.prototype.negate=function(){this.x=-this.x,this.y=-this.y},e.prototype.angle=function(t){var n=this.dot(t)/(this.length()*t.length());return-1>n&&(n=-1),n>1&&(n=1),Math.acos(n)},t.exports=e},function(t,n,e){"use strict";var r=e(4),o=e(10),i=e(5),a=e(20),s=e(21),u=e(24),c=function(){};c.createRing=function(t,n){for(var e=[],r=0,o=t.length;o>r;r++)e.push(n.getAtom(t[r]));for(var i=[],s=0,u=e.length-1;u>s;s++){var c=n.findBond(e[s],e[s+1]);null!==c&&i.push(c)}var l=n.findBond(e[0],e[e.length-1]);return null!==l&&i.push(l),new a(e,i)},c.isCandidateInSet=function(t,n,e,r){for(var o=0,i=n.length;i>o;o++){var a=n[o];if(t.length>=a.length){for(var s=!0,u=0;u<a.length;u++)t.includes(a[u])||(s=!1);if(s)return!0}for(var c=0;c<t.length;c++)a.includes(t[c])&&r[c]++}for(var l=!1,f=0,d=t.length;d>f;f++)r[t[f]]<e[t[f]]-1&&(l=!0);if(l){for(var h=0,m=t.length;m>h;h++)r[t[h]]++;return!1}return!0},c.verifySSSR=function(t,n,e){for(var r=[],o=[],a=0,s=e.countAtoms();s>a;a++)o.push(e.getAtom(a).countBonds());for(var c=i.zeros(e.countAtoms()),l=0,f=t.length;f>l;l++){var d=t[l];if(!u.isCandidateInSet(d,r,o,c)&&(r.push(d),r.length===n))return r}return r},c.detectRingAtoms=function(t){var n=t.countAtoms();if(n){var e=i.full(n,!1),r=[],o=t.atoms[0];o.depth=0,r.push(o);for(var a=[!0];;){if(!r.length)break;var s=r[0];r.shift();for(var u=Array.from(s.bonds),c=0,l=u.length;l>c;c++){var f=u[c],d=f.index;if(!e[d]){e[d]=!0;var h=f.otherAtom(s),m=h.index;if(a[m]){var g=[],p=void 0;if(s.depth===h.depth)g.push(s),g.push(h),p=s.depth;else{h.isInCycle=!0;for(var y=h.getNeighbors(),v=0,b=y.length;b>v;v++){var x=y[v];x.depth===h.depth-1&&g.push(x)}p=s.depth}for(;;){g[0].isInCycle=!0,g[1].isInCycle=!0,p--;for(var A=g[0].getNeighbors(),S=0,E=A.length;E>S;S++)if(A[S].depth===p){g[0]=A[S];break}for(var w=g[1].getNeighbors(),C=0,B=w.length;B>C;C++)if(w[C].depth===p){g[1]=w[C];break}if(g[0]===g[1]){g[0].isInCycle=!0;break}}}else h.depth=s.depth+1,a[m]=!0,r.push(h)}}}}},c.createRingSystems=function(t){for(var n=[],e=t.countAtoms(),a=i.full(e,!1),l=i.full(e,!1),f=i.full(e,-1),d=0,h=t.countAtoms();h>d;d++){var m=t.atoms[d];if(!a[m.index]&&m.isInCycle){var g=new t.constructor,p=[];p.push(m),a[0]=!0;var y=new r;for(y.index2=m.index,f[m.index]=0,g.addAtom(y);;){if(!p.length)break;var v=p[0];p.shift();for(var b=Array.from(v.bonds),x=0,A=b.length;A>x;x++){var S=b[x],E=S.index;if(!l[E]){l[E]=!0;var w=S.otherAtom(v),C=w.index;if(w.isInCycle)if(a[C]){var B=t.findBond(v,w),P=new o(g.atoms[f[v.index]],g.atoms[f[w.index]]);P.index2=B.index,g.addBond(P)}else{a[C]=!0,p.push(w),y=new r,y.index2=w.index,f[w.index]=g.atoms.length,g.addAtom(y);var O=new o(g.atoms[f[v.index]],y);O.index2=S.index,g.addBond(O)}}}}for(var I=0,R=g.atoms.length;R>I;I++)g.atoms[I].index=I;for(var D=0,N=g.bonds.length;N>D;D++)g.bonds[D].index=D;var L,M=g.bonds.length-g.atoms.length+1,T=s.findRings(g,6);T.length>=M?(L=c.verifySSSR(T,M,g),L.length<M&&(L=u.findRings(g))):L=u.findRings(g);for(var k=0,j=L.length;j>k;k++)for(var F=L[k],_=0,U=F.length;U>_;_++)F[_]=g.atoms[F[_]].index2;for(var z=0,G=L.length;G>z;z++)n.push(c.createRing(L[z],t))}}return n},c.findRings=function(t){var n=t.countBonds()-t.countAtoms()+t.fragmentCount;if(!n)return[];for(var e=0,r=t.atoms.length;r>e;e++){var o=t.atoms[e];o.index=e,o.depth=void 0,o.isInCycle=void 0,t.atoms[e].index=e}for(var i=0,a=t.bonds.length;a>i;i++)t.bonds[i].index=i;return c.detectRingAtoms(t),c.createRingSystems(t)},t.exports=c},function(t,n,e){"use strict";var r=e(7),o=e(9),i=function(t,n){this.atoms=t,this.bonds=n,this.flags=new Array(o.MAX_FLAG_INDEX+1),this._center=null};i.prototype.setFlag=function(t,n){this.flags[t]=n},i.prototype.getCenter=function(){if(!this._center){for(var t=0,n=0,e=0,o=this.atoms.length;o>e;e++)t+=this.atoms[e].coord.x,n+=this.atoms[e].coord.y;this._center=new r(t/this.atoms.length,n/this.atoms.length)}return this._center},i.prototype.resetRingCenter=function(){this._center=void 0},i.prototype.toString=function(){return"RingRing \n	"+this.atoms.forEach(function(t){return" "+t.toString()}.map(this).join("\n	"))+"\n	"+this.bonds.map(function(t){return" "+t.toString()},this).join("\n	")+"\n	"},t.exports=i},function(t,n,e){"use strict";var r=e(5),o=e(20),i=e(22),a=function(){};a.findRings=function(t,n){for(var e=[],r=new i(t),o=0,a=t.countAtoms();a>o;o++)for(var s=r.remove(t.getAtom(o),n),u=0;u<s.length;u++){var c=s[u],l=c.atoms;l.pop();for(var f=0,d=l.length;d>f;f++)l[f]=t.indexOfAtom(l[f]);e.push(l)}return e.sort(),e},a.createRing=function(t,n){for(var e=[],i=0,a=t.length-1;a>i;i++){var s=n.findBond(t[i],t[i+1]);null!==s&&e.push(s)}r.removeAt(t,t.length-1);var u=new o(t,e);return u},t.exports=a},function(t,n,e){"use strict";var r=e(5),o=e(23),i=function(t){this.edges=[],this.atoms=[];for(var n=0,e=t.countBonds();e>n;n++){var r=t.getBond(n),i=[r.source,r.target];this.edges.push(new o(i))}for(var a=0,s=t.countAtoms();s>a;a++)this.atoms.push(t.getAtom(a))};i.prototype.remove=function(t,n){for(var e=this.getEdges(t),o=[],i=0,a=e.length;a>i;i++)e[i].isCycle()&&o.push(e[i]);e=r.diff(e,o),this.edges=r.diff(this.edges,o);var s=this.spliceEdges(e);this.edges=r.diff(this.edges,e);for(var u=0;u<s.length;u++)!this.edges.includes(s[u])&&s[u].atoms.length<=n+1&&this.edges.push(s[u]);return r.remove(this.atoms,t),o},i.prototype.getEdges=function(t){for(var n=[],e=0,r=this.edges.length;r>e;e++){var o=this.edges[e];if(o.isCycle())o.atoms.includes(t)&&n.push(o);else{var i=o.atoms.length-1;o.atoms[0]!==t&&o.atoms[i]!==t||n.push(o)}}return n},i.prototype.spliceEdges=function(t){for(var n=[],e=0,r=t.length;r>e;e++)for(var o=e+1;r>o;o++){var i=t[o].splice(t[e]);null!==i&&n.push(i)}return n},t.exports=i},function(t,n){"use strict";var e=function(t){this.atoms=t};e.prototype.isCycle=function(){var t=this.atoms.length-1;return this.atoms.length>2&&this.atoms[0]===this.atoms[t]},e.prototype.splice=function(t){for(var n=this.getIntersection(t.atoms),r=[],o=0,i=this.atoms.length;i>o;o++)r.push(this.atoms[o]);if(this.atoms[0]===n&&r.reverse(),t.atoms[0]===n)for(var a=1,s=t.atoms.length;s>a;a++)r.push(t.atoms[a]);else for(var u=t.atoms.length-2;u>=0;u--)r.push(t.atoms[u]);return this.isRealPath(r)?new e(r):null},e.prototype.isRealPath=function(t){for(var n=1,e=t.length-1;e>n;n++)for(var r=1;e>r;r++)if(n!==r&&t[n]===t[r])return!1;return!0},e.prototype.getIntersection=function(t){var n=this.atoms.length-1,e=t.length-1;if(this.atoms[n]===t[0]||this.atoms[n]===t[e])return this.atoms[n];if(this.atoms[0]===t[0]||this.atoms[0]===t[e])return this.atoms[0];throw new Error("Couldn't splice - no intersection")},t.exports=e},function(t,n){"use strict";var e=function(){};e.deepCopy=function(t){for(var n=[],r=0,o=t.length;o>r;r++){var i=t[r];i instanceof Array?n.push(e.deepCopy(i)):n.push(i)}return n},e.matrixToHTML=function(t){for(var n="",e=t.length,r=0;e>r;r++){for(var o=0;e>o;o++)n+=JSON.stringify(t[r][o])+" ";n+="<br>"}return n},e.createEmptyMatrix=function(t){for(var n=[],e=0;t>e;e++){for(var r=[],o=0;t>o;o++)r.push(0);n.push(r)}return n},e.createWeightMatrix=function(t,n){for(var e=[],r=0;n>r;r++){for(var o=[],i=0;n>i;i++)r===i?o.push(0):t.findBond(t.getAtom(r),t.getAtom(i))?o.push(1):o.push(99999999);e.push(o)}return e},e.createEmptyPIDMatrix=function(t){for(var n=[],e=0;t>e;e++){for(var r=[],o=0;t>o;o++)r.push([]);n.push(r)}return n},e.createPIDMatrix=function(t,n){for(var e=[],r=0;n>r;r++){for(var o=[],i=0;n>i;i++){var a=t.getAtom(r),s=t.getAtom(i),u=t.findBond(a,s);u?o.push([[t.indexOfBond(u)]]):o.push([])}e.push(o)}return e},e.appendPath=function(t,n,e){t.length?t.push(n[0].concat(e[0])):t[0]=n[0].concat(e[0])},e.makePIDMatrixes=function(t){for(var n=t.countAtoms(),r=e.createWeightMatrix(t,n),o=e.createPIDMatrix(t,n),i=e.createEmptyPIDMatrix(n),a=r,s=0;n>s;s++)for(var u=0;n>u;u++)for(var c=0;n>c;c++){var l=a[u][c],f=a[u][s]+a[s][c],d=o[u][s],h=o[s][c];1e8!==f&&(l>f?(l===f+1?i[u][c]=e.deepCopy(o[u][c]):i[u][c]=[],r[u][c]=f,o[u][c]=[d[0].concat(h[0])]):l===f?d.length&&h.length&&e.appendPath(o[u][c],d,h):l===f-1?e.appendPath(i[u][c],d,h):r[u][c]=a[u][c])}return{D:r,Pe1:o,Pe2:i}},e.sortByCnum=function(t,n){return t.Cnum-n.Cnum},e.makeCandidateSet=function(t,n,r){for(var o=t.length,i=[],a=0;o>a;a++)for(var s=0;o>s;s++)if(0!==t[a][s]&&(1!==n[a][s].length||0!==r[a][s].length)){var u;u=r[a][s].length?2*(t[a][s]+.5):2*t[a][s],i.push({Cnum:u,Pe1:n[a][s],Pe2:r[a][s]})}return i.sort(e.sortByCnum),i},e.isCandidateInSet=function(t,n,e,r){for(var o=0,i=n.length;i>o;o++){var a=n[o];if(t.length>=a.length){for(var s=!0,u=0,c=a.length;c>u;u++)t.includes(a[u])||(s=!1);if(s)return!0}for(var l=0;l<t.length;l++)a.includes(t[l])&&r[l]++}for(var f=!1,d=0;d<t.length;d++)r[t[d]]<e[t[d]]-1&&(f=!0);if(f){for(var h=0;h<t.length;h++)r[t[h]]++;return!1}return!0},e.bondRingToAtomRing=function(t,n){for(var e=[],r=0,o=t.length;o>r;r++){var i=n.getBond(t[r]),a=n.indexOfAtom(i.source),s=n.indexOfAtom(i.target);e.includes(a)||e.push(a),e.includes(s)||e.push(s)}return e},e.processCandidate=function(t,n,r,o,i){var a=e.bondRingToAtomRing(t,r);t.length===a.length&&(e.isCandidateInSet(a,n,o,i)||n.push(a))},e.candidateSearch=function(t,n,r,o){for(var i=[],a=[],s=0,u=r.countAtoms();u>s;s++)a.push(r.getAtom(s).countBonds());for(var c=[],l=0;l<r.countAtoms();l++)c[l]=0;for(var f=0,d=t.length;d>f;f++){var h=t[f];if(h.Cnum%2)for(var m=0,g=h.Pe2.length;g>m;m++){var p=h.Pe1[0].concat(h.Pe2[m]);if(e.processCandidate(p,i,r,a,c),i.length===n)return i}else for(var y=0,v=h.Pe1.length-1;v>y;y++){var b=h.Pe1[y].concat(h.Pe1[y+1]);if(e.processCandidate(b,i,r,a,c),i.length===n)return i}}return i},e.sortByPath=function(t,n){for(var e=[t[0]],r=n.getAtom(t[0]),o=0;t.length!==e.length&&(o++,!(o>1e3));)for(var i=1,a=t.length;a>i;i++){var s=n.getAtom(e[e.length-1]),u=n.getAtom(t[i]);e.includes(t[i])||(n.findBond(s,u)?e.push(t[i]):n.findBond(r,u)&&e.splice(0,0,t[i]))}return e},e.findRings=function(t){var n=t.countBonds()-t.countAtoms()+1;if(!n)return[];for(var r=e.makePIDMatrixes(t),o=e.makeCandidateSet(r.D,r.Pe1,r.Pe2),i=e.candidateSearch(o,n,t,r.D),a=0,s=i.length;s>a;a++)i[a]=e.sortByPath(i[a],t);return i},t.exports=e},function(t,n){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),o=function(){function t(n){e(this,t),this.molObj=this.processMolecule(n)}return r(t,[{key:"processAtom",value:function(t){var n={},e=t.coord;return n.l=t.symbol,n.x=e.x,n.y=e.y,n.c=t.charge,n}},{key:"processBond",value:function(t,n){var e={},r=t.source,o=t.target;switch(e.b=n.indexOfAtom(r),e.e=n.indexOfAtom(o),e.o=t.order,t.stereo){case 10:e.s="none";break;case 11:e.s="protuding";break;case 12:e.s="ambiguous";break;case 13:e.s="recessed";break;default:e.s="none"}return e}},{key:"processMolecule",value:function(t){var n={},e=[],r={},o=t.atoms,i=t.bonds;r.a=o.map(this.processAtom),r.b=[];for(var a=0;a<i.length;a++)r.b.push(this.processBond(i[a],t));return e[0]=r,n.m=e,n.s=[],n}},{key:"toJson",value:function(){return JSON.stringify(this.molObj)}}]),t}();t.exports=o},function(t,n,e){"use strict";var r=e(7),o=e(18),i=e(8),a=e(9),s=e(11),u=e(27),c=e(5),l=e(28),f=e(29),d=e(31),h=function(){};h.bondLength=l.bondLength,h.generate=function(t){for(var n=0,e=new o(0,1),i=t.countAtoms(),s=0;i>s;s++){var l=t.getAtom(s);l.setFlag(a.ISPLACED,!1),l.setFlag(a.VISITED,!1),l.setFlag(a.ISINRING,!1),l.setFlag(a.ISALIPHATIC,!1)}if(1===i)return t.getAtom(0).coords=new r(0,0),t;if(t.fragmentCount>1)throw Error("Molecule not connected.");var g,p=t.countBonds(),y=p-t.countAtoms()+1,v=t.getRings(),b=new u.GetPartitionedRings(v);if(y>0){v.forEach(function(t){t.atoms.forEach,function(t){t.setFlag(a.ISINRING,!0)}}),b.sort(function(t,n){return c.defaultCompare(t.length,n.length)});var x=c.last(b);this.ringSet(e,x),m.placeRingSubstituents(t,x,h.bondLength),x.forEach(function(t){t.isPlaced=!0})}else{var A=f.getInitialLongestChain(t);A.getAtom(0).coord=new r(0,0),A.getAtom(0).flags[a.ISPLACED]=!0,g=Math.PI*(-30/180),f.placeLinearChain(A,e,h.bondLength)}var n=0;do n++,h.handleAliphatics(t,p,h.bondLength),m.layoutNextRingSystem(e,t,v,b);while(!f.allPlaced(t,i)&&n<=t.countAtoms());return d.resolveOverlap(t,v),t},h.placeFirstBond=function(t,n){return n.normalize(),n.scale(h.bondLength),t.source.coord=new r(0,0),t.source.setFlag(a.ISPLACED,!0),t.target.coord=new r(n.x,n.y),t.target.setFlag(a.ISPLACED,!0),[t.source,t.target]},h.allPlaced=function(t){for(var n=0;n<t.length;n++)if(!t[n].flags[a.ISPLACED])return!1;return!0},h.getNextAtomWithAliphaticUnplacedNeigbors=function(t,n){for(var e=0;n>e;e++){var r=t.getBond(e);if(r.source.flags[a.ISPLACED]&&!r.target.flags[a.ISPLACED])return r.source;if(!r.source.flags[a.ISPLACED]&&r.target.flags[a.ISPLACED])return r.target}return null},h.getAtoms=function(t,n,e,r){for(var o=new s,i=n.getConnectedBondsList(t),u=0,c=i.length;c>u;u++){var l=i[u].otherAtom(t);r&&l.flags[a.ISPLACED]?o.addAtom(l):r||l.flags[a.ISPLACED]||o.addAtom(l)}return o},h.handleAliphatics=function(t,n,e){var r,i=0;do{i++;var s=!1;r=h.getNextAtomWithAliphaticUnplacedNeigbors(t,n);var u=null,c=null;if(null!==r){var l=h.getAtoms(r,t,n,!1),d=h.getAtoms(r,t,n,!0),m=f.getLongestUnplacedChain(t,r);if(m.countAtoms()>1){d.countAtoms()>1?(f.distributePartners(r,d,f.get2DCenter(d),l,e),u=new o(m.getAtom(1).coord.x,m.getAtom(1).coord.y),c=new o(r.coord.x,r.coord.y),u.sub(c)):u=f.getNextBondVector(r,d.getAtom(0),f.get2DCenter(t),!0);for(var g=1,p=m.countAtoms();p>g;g++)m.getAtom(g).flags[a.ISPLACED]=!1;f.placeLinearChain(m,u,e)}else s=!0}else s=!0}while(!s&&i<=t.countAtoms())},h.getMostComplexRing=function(t){for(var n=new Array(t.length),e=0;e<n.length;e++)n[e]=0;for(var r=0,o=0,i=0;i<t.length;i++)for(var a=t[i],s=0;s<a.atoms.length;s++)for(var u=a[s],c=i+1;c<t.length;c++){var l=t[c];if(a!==l)for(var f=0;f<l.atoms.length;f++){var d=l[f];if(u===d){n[i]++,n[c]++;break}}}for(var h=0;h<n.length;h++)n[h]>r&&(r=n[h],o=h);return t[o]},h.ringSet=function(t,n){var e=l.bondLength,i=h.getMostComplexRing(n);if(!i.flags[a.ISPLACED]){var s={atoms:h.placeFirstBond(i.bonds[0],t),bonds:[i.bonds[0]]},u=s.atoms.reduce(function(t,n){return r.sum(t,n.coord)},new r(0,0)),c=new o(u.x/s.atoms.length,u.y/s.atoms.length),f=m.getRingCenterOfFirstRing(i,t,e);m.placeRing(i,s,c,f,e),i.setFlag(a.ISPLACED,!0)}var d=0;do i.flags[a.ISPLACED]&&(m.placeConnectedRings(n,i,"FUSED",e),m.placeConnectedRings(n,i,"BRIDGED",e),m.placeConnectedRings(n,i,"SPIRO",e)),d++,d===n.length&&(d=0),i=n[d];while(!h.allPlaced(n))};var m=function(){};m.getRingCenterOfFirstRing=function(t,n,e){var r=t.atoms.length,i=e/(2*Math.sin(Math.PI/r)),a=Math.sqrt(Math.pow(i,2)-Math.pow(e/2,2)),s=f.getAngle(n.x,n.y);return s+=Math.PI/2,new o(Math.cos(s)*a,Math.sin(s)*a)},m.placeRing=function(t,n,e,r,o){var i=n.atoms.length;i>2?m.placeBridgedRing(t,n,e,r,o):2===i?m.placeFusedRing(t,n,e,r,o):1===i&&m.placeSpiroRing(t,n,e,r,o)},m.placeRingSubstituents=function(t,n,e){var r=new s,o=0;return n.forEach(function(i){i.atoms.forEach(function(i){var a=new s,u=new s,l=n.filter(function(t){return t.atoms.includes(i)}),d=c.flatten(l.map(function(t){return t.atoms})),h=m.center(d);o+=f.partitionPartners(t,i,a,u),f.markNotPlaced(a.atoms),a.atoms.forEach(function(t){r.addAtom(t)}),a.atoms.length>0&&f.distributePartners(i,u,h,a,e)})}),r},m.placeBridgedRing=function(t,n,e,a,s){var u=m.getNativeRingRadius(t.atoms.length,s);a.normalize(),a.scale(u);var c=new r(e.x+a.x,e.y+a.y),l=m.getBridgeAtoms(n),d=l[0],h=l[1],g=new o(d.coord.x,d.coord.y),p=new o(h.coord.x,h.coord.y);g.sub(a),p.sub(a);var y=g.angle(p),v=2*Math.PI-y,b=v/(t.atoms.length-n.atoms.length+1),x=m.findStartAtom(a,d,h),A=i.toRadians(i.angle(x.coord.x,x.coord.y,a.x,a.y)),S=m.atomsInPlacementOrder(x,n.bonds[0],t.bonds),b=b*m.findDirection(a,d,h);f.populatePolygonCorners(S,c,A,b,u)},m.atomsInPlacementOrder=function(t,n,e){var r=e.find(function(n){return n.otherAtom(t)}),o=e.filter(function(t){return t!==r});if(o.length>0){var i=r.otherAtom(t);return[].concat.call(i,m.atomsInPlacementOrder(i,r,o))}return[]},m.findDirection=function(t,n,e){var o=1,i=r.difference(n.coord,e.coord);return 0===i.x?t.x>n.coord.x&&(o=-1):t.y-n.coord.y<(t.x-n.coord.x)*i.y/i.x&&(o=-1),o},m.findStartAtom=function(t,n,e){var o=r.difference(n.coord,e.coord);if(0===o.x){if(n.coord.y>e.coord.y)return n}else if(n.coord.x>e.coord.x)return n;return e},m.getBridgeAtoms=function(t){var n=[];return t.atoms.forEach(function(e){Array.from(e.bonds).forEach(function(r){t.bonds.includes(r)&&n.push(r.otherAtom(e))})}),n},m.placeFusedRing=function(t,n,e,i,a){var s=m.getNativeRingRadius(t.atoms.length,a),u=Math.sqrt(Math.pow(s,2)-Math.pow(a/2,2));i.normalize(),i.scale(u);var c=new r(e.x+i.x,e.y+i.y),l=n.atoms[0],d=n.atoms[1],h=new o(l.coord.x,l.coord.y),g=new o(d.coord.x,d.coord.y),p=new o(c.x,c.y);h.sub(p),g.sub(p);var y=h.angle(g),v=2*Math.PI-y,b=v/(t.atoms.length-1),x=c.x,A=c.y,S=l.coord.x-d.coord.x,E=l.coord.y-d.coord.y,w=1;if(0===S){var C;C=l.coord.y>d.coord.y?l:d,w=x<l.coord.x?1:-1}else C=l.coord.x>d.coord.x?l:d,w=A-l.coord.y>(x-l.coord.x)*E/S?1:-1;for(var B=f.getAngle(C.coord.x-c.x,C.coord.y-c.y),P=C,O=n.bonds[0],I=[],R=0,D=t.bonds.length-2;D>R;R++)O=m.getNextBond(t,O,P),P=O.otherAtom(P),I.push(P);b*=w,f.populatePolygonCorners(I,c,B,b,s)},m.getNextBond=function(t,n,e){for(var r=0;r<t.bonds.length;r++)if(t.bonds[r]!==n&&(t.bonds[r].source===e||t.bonds[r].target===e))return t.bonds[r];return null},m.placeSpiroRing=function(t,n,e,o,i){var a=m.getNativeRingRadius(t.atoms.length,i);o.normalize(),o.scale(a);var s=new r(e.x+o.x,e.y+o.y),u=2*Math.PI/t.atoms.length,c=n.atoms[0],l=f.getAngle(c.coord.x-s.x,c.coord.y-s.y),d=m.atomsInPlacementOrder(c,n.bonds[0],t.bonds);f.populatePolygonCorners(d,s,l,u,a)},m.getNativeRingRadius=function(t,n){return n/(2*Math.sin(Math.PI/t))},m.getIntersectingAtoms=function(t,n){var e=[];return n.atoms.forEach(function(n){t.atoms.includes(n)&&e.push(n)}),e},m.getIntersectingBonds=function(t,n){var e=[];return n.bonds.forEach(function(n){t.bonds.includes(n)&&e.push(n)}),e},m.center=function(t){var n=t.reduce(function(t,n){return r.sum(t,n.coord)},new r(0,0));return new r(n.x/t.length,n.y/t.length)},m.placeConnectedRings=function(t,n,e,i){for(var s=u.directConnectedRings(n,t),c=0,l=s.length;l>c;c++){var d=s[c];if(!d.flags[a.ISPLACED]){var h={atoms:m.getIntersectingAtoms(n,d),bonds:m.getIntersectingBonds(n,d)},g=h.atoms.length;if(2===g&&"FUSED"===e||1===g&&"SPIRO"===e||g>2&&"BRIDGED"===e){for(var p="",y=0;y<h.atoms.length;y++)p+="\n         "+h.atoms[y].coord+" "+h.atoms[y].flags[a.ISPLACED];var v=f.getAtoms2DCenter(h.atoms),b=f.getAtoms2DCenter(n.atoms),x=new o(v.x,v.y),A=new o(x.x,x.y);A.sub(new o(b.x,b.y));new o(A.x,A.y),new r(v.x+A.x,v.y+A.y);m.placeRing(d,h,v,A,i),d.setFlag(a.ISPLACED,!0),m.placeConnectedRings(t,d,e,i)}}}},m.resetUnplacedRingAtoms=function(t){t.forEach(function(t){t.isPlaced||t.atoms.forEach(function(t){return t.setFlag(a.ISPLACED,!1)})})},m.findNextRingBondWithUnplacedRingAtom=function(t){t.find(function(t){[t.source,t.target].some(function(n){n.flags[a.ISINRING]&&!n.flags[a.ISPLACED]&&t.otherAtom(n).flags[a.ISPLACED]})})},m.layoutNextRingSystem=function(t,n,e,r){m.resetUnplacedRingAtoms(e);var i=n.atoms.filter(function(t){return t.flags[a.ISPLACED]}),s=m.findNextRingBondWithUnplacedRingAtom(n.bonds);if(s){var u=[s.source,s.target].find(function(t){return t.flags[a.ISINRING]&&!t.flags[a.ISPLACED]}),d=s.otherAtom(u),g=r.find(function(t){return t.find(function(t){return t.atoms.includes(u)})}),p=u.coord.clone(),y=d.coord.clone();h.ringSet(t,g),f.markNotPlaced(i);var v=m.placeRingSubstituents(n,g,l.bondLength);f.markPlaced(i),i=[].concat.call(v.atoms,c.flatten(g.map(function(t){return t.atoms}))),c.removeDuplicates(i);var b=p,x=y,A=u.coord,S=d.coord,E=f.getAngle(b.x-x.x,b.y-x.y),w=f.getAngle(A.x-S.x,A.y-S.y),C=E-w,B=new o(x.x,x.y);B.sub(new o(S.x,S.y)),i.forEach(function(t){t.coord.x+=B.x,t.coord.y+=B.y});var P=Math.cos(C),O=Math.sin(C);i.forEach(function(t){var n=t.coord,e=n.x-x.x,r=n.y-x.y;n.x=e*P-r*O+x.x,n.y=e*O+r*P+x.y}),g.forEach(function(t){t.isPlaced=!0})}},t.exports=h},function(t,n,e){"use strict";var r=e(5),o=function(){};o.GetPartitionedRings=function(t){var n=[],e=t;return t.forEach(function(t){if(!r.flatten(n).find(function(n){return n===t})){var i=n.find(function(n){return n.find(function(n){return n===t})});void 0===i&&(i=[t],e=e.filter(function(n){return n!==t}));var a=o.directConnectedRings(t,e);i=[].concat(i,a),e=e.filter(function(t){return a.find(function(n){return n===t})}),n.push(i)}}),n},o.directConnectedRings=function(t,n){var e=[];return n.forEach(function(n){var r=n.atoms.some(function(e){return n===t?!1:t.atoms.find(function(t){return t===e})});r&&e.push(n)}),e},t.exports=o},function(t,n){"use strict";var e={bondLength:1.5};t.exports=e},function(t,n,e){"use strict";var r=e(7),o=e(18),i=e(9),a=e(11),s=e(30),u=function(){};u.getInitialLongestChain=function(t){for(var n=s.getMatrix(t),e=u.computeFloydAPSP(n),r=0,o=-1,i=-1,a=t.countBonds(),c=e.length,l=0;c>l;l++){var f=t.getAtom(l),d=u.getConnectedBondsCount(f,t,a);if(1===d)for(var h=0;c>h;h++)e[l][h]>r&&(r=e[l][h],o=l,i=h)}var m=t.getAtom(o),g=u.getLongestUnplacedChain(t,m);return g},u.computeFloydAPSP=function(t){for(var n=t.length,e=new Array(n),r=0;n>r;++r)e[r]=new Array(n);for(var o=0;n>o;o++)for(var i=0;n>i;i++)0===t[o][i]?e[o][i]=999999:e[o][i]=1;for(var a=0;n>a;a++)e[a][a]=0;for(var s=0;n>s;s++)for(var u=0;n>u;u++)for(var c=0;n>c;c++)e[u][s]+e[s][c]<e[u][c]&&(e[u][c]=e[u][s]+e[s][c]);return e},u.getLongestUnplacedChain=function(t,n){for(var e=0,r=0,o=0,s=0,c=[],l=t.countAtoms(),f=t.countBonds(),d=0;l>d;d++)t.getAtom(d).setFlag(i.VISITED,!1),c[d]=new a,c[d].addAtom(n);var h=[];h.push(n),n.flags[i.VISITED]=!0,u.breadthFirstSearch(t,h,c,f);for(var m=0;l>m;m++)c[m].countAtoms()>=r&&(s=u.getDegreeSum(c[m],t,f),s>o&&(o=s,e=m,r=c[m].countAtoms()));return c[e]},u.getDegreeSum=function(t,n,e){for(var r=0,o=t.countAtoms(),i=0;o>i;i++)r+=u.getConnectedBondsCount(t.getAtom(i),n,e);return r},u.getConnectedBondsCount=function(t,n,e){for(var r=0,o=0;e>o;o++)n.getBond(o).source!==t&&n.getBond(o).target!==t||r++;return r},u.breadthFirstSearch=function(t,n,e,r){for(var o=[],a=n.length,s=0;a>s;s++){var c=n[s];if(!c.flags[i.ISINRING])for(var l=t.indexOfAtom(c),f=t.getConnectedBondsList(c),d=0;d<f.length;d++){var h=f[d],m=h.otherAtom(c);if(!m.flags[i.VISITED]&&!m.flags[i.ISPLACED]){var g=t.indexOfAtom(m);e[g]=u.copyPath(e[l]),e[g].addAtom(m),e[g].addBond(h),u.getConnectedBondsCount(m,t,r)>1&&o.push(m)}}}if(o.length>0){for(var p=0;p<o.length;p++)o[p].setFlag(i.VISITED,!0);u.breadthFirstSearch(t,o,e,r)}},u.copyPath=function(t){for(var n=new a,e=0,r=t.countAtoms();r>e;e++)n.addAtom(t.getAtom(e));return n},u.placeLinearChain=function(t,n,e){for(var o=n,a=0;a<t.countAtoms()-1;a++){var s=t.getAtom(a),c=t.getAtom(a+1),l=new r(s.coord.x,s.coord.y);o.normalize(),o.scale(e),l.x+=o.x,l.y+=o.y,c.coord=l,c.setFlag(i.ISPLACED,!0);var f=!0;2===u.has2DCoordinatesNew(t)&&(f=!1),o=u.getNextBondVector(c,s,u.get2DCenter(t),f)}},u.has2DCoordinatesNew=function(t){if(null===t)return 0;var n=!1,e=!1;return t.atoms.forEach(function(t){null===t.coord||0===t.coord.x&&0===t.coord.y?n=!0:e=!0}),!n&&e?2:n&&e?1:0},u.get2DCenter=function(t){for(var n=0,e=0,o=0,a=0,s=t.countAtoms();s>a;a++){var u=t.getAtom(a);u.flags[i.ISPLACED]===!0&&(n+=u.coord.x,e+=u.coord.y,o++)}var c=new r(n/o,e/o);return c},u.getAtoms2DCenter=function(t){for(var n=0,e=0,o=0,a=0,s=t.length;s>a;a++){var u=t[a];u.flags[i.ISPLACED]===!0&&(n+=u.coord.x,e+=u.coord.y,o++)}var c=new r(n/o,e/o);return c},u.getAngle=function(t,n){var e=0;return t>=0&&n>=0?e=Math.atan(n/t):0>t&&n>=0?e=Math.PI+Math.atan(n/t):0>t&&0>n?e=Math.PI+Math.atan(n/t):t>=0&&0>n&&(e=2*Math.PI+Math.atan(n/t)),e},u.getNextBondVector=function(t,n,e,i){var a=u.getAngle(n.coord.x-t.coord.x,n.coord.y-t.coord.y),s=Math.PI*(120/180);i||(s=Math.PI*(60/180)),a+=s;var c=new o(Math.cos(a),Math.sin(a)),l=new r(t.coord.x+c.x,t.coord.y+c.y),f=r.distance(l,e);a+=s;var d=new o(Math.cos(a),Math.sin(a)),h=new r(t.coord.x+d.x,t.coord.y+d.y),m=r.distance(h,e);return m>f?d:c},u.allPlaced=function(t,n){for(var e=0;n>e;e++)if(!t.getAtom(e).flags[i.ISPLACED])return!1;return!0},u.distributePartners=function(t,n,e,i,a){var s=0,c=0,l=0,f=0,d=0,h=new o(e.x,e.y),m=new o(t.coord.x,t.coord.y),g=new o(e.x,e.y);g.sub(m);var p=[],y=n.countAtoms(),v=i.countAtoms();if(1===y){for(var b=0;v>b;b++)p.push(i.getAtom(b));l=2*Math.PI/(v+y);var x=n.getAtom(0),A=x.coord.x-t.coord.x,S=x.coord.y-t.coord.y;return c=u.getAngle(A,S),void u.populatePolygonCorners(p,new r(t.coord.x,t.coord.y),c,l,a)}if(0===y){for(var E=0;v>E;E++)p.push(i.getAtom(E));return l=2*Math.PI/v,c=0,void u.populatePolygonCorners(p,new r(t.coord.x,t.coord.y),c,l,a)}var w=[];h.sub(m),m=h,m.normalize(),m.scale(a),m.negate();var C=new r(t.coord.x,t.coord.y);C.x+=m.x,C.y+=m.y;for(var B=0;y>B;B++)w.push(n.getAtom(B));u.sortBy2DDistance(w,C);var P=new o(w[0].coord.x,w[0].coord.y),O=new o(w[1].coord.x,w[1].coord.y);P.sub(new o(t.coord.x,t.coord.y)),O.sub(new o(t.coord.x,t.coord.y)),s=P.angle(g),s+=O.angle(g);var I=u.getAngle(w[0].coord.x-t.coord.x,w[0].coord.y-t.coord.y),R=(u.getAngle(w[1].coord.x-t.coord.x,w[1].coord.y-t.coord.y),u.getAngle(C.x-t.coord.x,C.y-t.coord.y)),D=null;D=I>R?I-R<Math.PI?w[1]:w[0]:R-I<Math.PI?w[0]:w[1],d=2*Math.PI-s,l=d/(v+1);for(var N=0;v>N;N++)p.push(i.getAtom(N));f=a,c=u.getAngle(D.coord.x-t.coord.x,D.coord.y-t.coord.y),u.populatePolygonCorners(p,new r(t.coord.x,t.coord.y),c,l,f)},u.sortBy2DDistance=function(t,n){var e;do{e=!1;for(var o=0,i=t.length;i-1>o;o++){var a=t[o],s=t[o+1],u=r.distance(n,a.coord),c=r.distance(n,s.coord);u>c&&(t[o]=s,t[o+1]=a,e=!0)}}while(e)},u.populatePolygonCorners=function(t,n,e,o,a){for(var s=[],u=e,c=0,l=t.length;l>c;c++){u+=o,u>=2*Math.PI&&(u-=2*Math.PI);var f=t[c];"H"===f.symbol&&(a*=.6);var d=Math.cos(u)*a,h=Math.sin(u)*a,m=d+n.x,g=h+n.y;s.push(new r(m,g))}for(var p=0;p<t.length;p++)f=t[p],f.coord=s[p],f.flags[i.ISPLACED]=!0},u.partitionPartners=function(t,n,e,r){var o=0;return Array.from(n.bonds).forEach(function(t){o++;var a=t.otherAtom(n);a.flags[i.ISPLACED]?r.addAtom(a):e.addAtom(a)}),o},u.markNotPlaced=function(t){t.forEach(function(t){return t.setFlag(i.ISPLACED,!1)})},u.markPlaced=function(t){t.forEach(function(t){return t.setFlag(i.ISPLACED,!0)})},t.exports=u},function(t,n){"use strict";var e=function(){};e.getMatrix=function(t){for(var n,e,r=t.countAtoms(),o=new Array(r),i=0;r>i;++i){o[i]=new Array(r);for(var a=0;r>a;a++)o[i][a]=0}for(var s=t.countBonds(),u=0;s>u;u++){var c=t.getBond(u);n=t.indexOfAtom(c.source),e=t.indexOfAtom(c.target),o[n][e]=1,o[e][n]=1}return o},e.display=function(t){for(var n="",e=t.length,r=0;e>r;r++){for(var o=0;e>o;o++)n+=void 0==t[r][o]?"[ ]":"["+t[r][o]+"]";n+="\n"}alert(n)},t.exports=e},function(t,n,e){"use strict";var r=e(7),o=e(18),i=e(26),a=function(){};a.resolveOverlap=function(t,n){var e=[],r=a.getOverlapScore(t,e);return r>0&&(r=a.displace(t,e)),r},a.getOverlapScore=function(t,n){for(var e=0,o=i.bondLength/5,a=t.countAtoms(),s=0;a>s;s++)for(var u=t.getAtom(s),c=u.coord,l=s+1;a>l;l++){var f=t.getAtom(l),d=f.coord,h=r.distance(c,d);o>h&&(e+=o,n.push(new Array(u,f)))}return e},a.displace=function(t,n){var e=25,r=0;do{var s=Math.round(Math.random()*n.length);s>=n.length&&(s=n.length-1);var u=n[s];if(void 0!==u){var c=u[0],l=u[1],f=(new o(c.coord.x,c.coord.y),new o(l.coord.x-c.coord.x,l.coord.y-c.coord.y));f.normalize(),isNaN(f.x)&&(f.x=.01),isNaN(f.y)&&(f.y=.01),f.scale(-1*i.bondLength/3);var d=Math.random();d>.5?(l.coord.x+=f.x,l.coord.y+=f.y):(c.coord.x-=f.x,c.coord.y-=f.y);var h=a.getOverlapScore(t,n);r++}else alert("problem layoutOverlapResolver.displace p is "+s+" and len "+n.length+" and "+u)}while(h>0&&!(r>e));return h},t.exports=a},function(t,n,e){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),i=e(33),a="",s=function(){function t(n){r(this,t),this.config=i,this.mol=n,this.sizeCalculator()}return o(t,[{key:"sizeCalculator",value:function(){this.scale=this.config.bondLength/this.mol.getAverageBondLength();var t=this.scale*this.config.marginWidth,n=this.mol.getBoundingBox();this.dx=this.scale*n.left-t,this.dy=this.scale*n.top-t,this.w=this.scale*(n.right-n.left)+2*t,this.h=this.scale*(n.bottom-n.top)+2*t}},{key:"writeHeader",value:function(t){a+="\n<svg version='1.2'\n    baseProfile='full'\n    width='"+this.w+"' height='"+this.h+"'\n    xmlns='http://www.w3.org/2000/svg'>\n<defs>\n    <filter x='-0.05' y='0.05' width='1.1' height='1.1' id='solid-bg'>\n        <feFlood flood-color='"+t+"'/>\n        <feComposite in='SourceGraphic'/>\n    </filter>\n</defs>\n\n<rect width='100%' height='100%' fill='"+t+"' stroke='black'/>\n  "}},{key:"_drawAtom",value:function(t){var n=this.config.fontSize,e=t.symbol,r=t.coord,o=t.hydrogenCount(),i=n/2,s=""+e;o>1?s+="<tspan>H<tspan dy='"+i+"'>"+o+"</tspan></tspan>":1===o&&(s+="<tspan>H</tspan>");var u=r.x*this.scale-this.dx,c=r.y*this.scale-this.dy;u-=n/2.5,c+=3*n/8,a+="<text x='"+u+"' y='"+c+"' font-family='Arial'\n        font-size='"+n+"'\n        fill='black'\n        filter='url(#solid-bg)'>"+s+"</text>\n"}},{key:"drawAtoms",value:function(){var t=this.mol.atoms.filter(function(t){return"C"===t.symbol?!1:t});t.forEach(this._drawAtom,this)}},{key:"_drawBond",value:function(t){var n=this.config.lineWidth,e=this.config.bondSpacing,r=t.source.coord.x*this.scale-this.dx,o=t.source.coord.y*this.scale-this.dy,i=t.target.coord.x*this.scale-this.dx,s=t.target.coord.y*this.scale-this.dy;1===t.order?a+="<line x1='"+r+"' y1='"+o+"' x2='"+i+"' y2='"+s+"' stroke='black'\n      stroke-width='"+n+"'/>\n":2===t.order&&(o+=e/2,s+=e/2,a+="<line x1='"+r+"' y1='"+o+"' x2='"+i+"' y2='"+s+"' stroke='black'\n      stroke-width='"+n+"'/>\n",o-=e,s-=e,a+="<line x1='"+r+"' y1='"+o+"' x2='"+i+"' y2='"+s+"' stroke='black'\n      stroke-width='"+n+"'/>\n")}},{key:"drawBonds",value:function(){this.mol.bonds.forEach(this._drawBond,this)}},{key:"toSvg",value:function(){return this.writeHeader(this.config.bgColor),a+="\n",this.drawBonds(),this.drawAtoms(),a+"</svg>"}}]),t}();t.exports=s},function(t,n){"use strict";var e=1.25,r={bgColor:"white",fontSize:10,bondLength:14.4,bondSpacing:2.592,lineWidth:.6,marginWidth:1.6*e};t.exports=r}])});